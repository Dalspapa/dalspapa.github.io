# TCP/IP 5계층

<br/>

## 📚 데이터(Data)
---
컴퓨터는 2진법으로 숫자를 표기하는데 0을 꺼짐, 1을 켜짐으로 구분한다. 데이터는 0과 1로 이루어진 긴 전기 신호를 말한다. 가장 작은 단위로 bit를 사용한다. 0 또는 1 하나가 1 bit를 차지한다. 8 bit를 1 byte라고 부르며, 보통 byte 단위를 사용한다.

<br/>
<br/>

## 📦 패킷(Packet)
---

네트워크 통신 시 데이터를 한꺼번에 전송하는 것이 아닌, 데이터를 작게 조각내어 주머니에 담아 전송하는데 이 주머니를 패킷이라고 한다. 패킷에는 조각으로 나누어진 파일 데이터와 주소와 에러 데이터 및 목적지 등이 기록된다.

패킷(Packet)은 **Pack**age(상자) + Buc**ket**(덩어리)의 합성어다.

<br/>

### 🤔 패킷 교환 방식의 문제점
---

하지만 패킷 교환 방식도 당연히 만능이 아니기에, 몇 가지 문제가 있었다. 우리가 TCP를 공부할 때 함께 따라오는 **ARQ**나 **SYN**, **ACK** 등의 개념들이 바로 이런 문제들을 해결하기 위해 과거의 엔지니어들이 머리를 싸맨 결과인 것이다.

> Q: 전송 중간에 패킷이 쥐도새도 모르게 사라지거나 훼손되면 어떡해요?
>
>> A: 그럼 그 패킷만 다시 보내라고 해!(ARQ)

> Q: 송신 측이 패킷을 쪼갠 순서를 알아야 수신 측이 재조립할 수 있겠는데요?
>> A: 그럼 순서번호를 패킷이랑 같이 보내!(시퀀스 번호)

> Q: 수신 측이 처리할 수 있는 속도보다 송신 측이 패킷을 빠르게 보내버리면 어떡하죠?
>> A: 그럼 수신 측이 처리할 수 있는 양을 송신 측에 알려주고 그 만큼만 보내라고 해! (슬라이딩 윈도우)

<br/>
<br/>

## 🤝 프로토콜(Protocol)
---

프로토콜은 '규약'이라는 뜻이다. 통신에서 프로토콜이란, 기기 간에 데이터가 전달되기 위해 정한 규칙을 말한다. 무작정 데이터가 전달되는 것이 아닌, 서로 특정한 약속 아래에서 데이터가 전달된다. 프로토콜에는 다양한 종류가 있는데, 사람들이 잘 알고있는 HTTP도 웹을 위한 프로토콜이다.

예시를 들어 정리해보자. 내가 친구에게 사진을 보내려고 한다. 컴퓨터에서 사진은 2진수로 구성된 데이터다. 사진이 00011011 이라고 가정하자. 친구에게 00011011을 한꺼번에 보내는 것이 아니라, 이를 잘게 나누어 패킷에 담은 후 보낸다. 이때 패킷만을 보내게 되면, 받는 사람은 이 패킷들을 어떤 순서로 조합해야 하는지 모른다. 00, 01, 10, 11으로 2자리씩 쪼갠다고 가정하자. 이때 무조건 패킷이 00, 01, 10, 11 순으로 전송되는 것이 아니다. 각 패킷들은 서로 다른 경로로 전송될 수 있는데, 10 패킷이 01 패킷보다 먼저 도착할 수도 있다. 그렇게 되면 수신자는 00100111으로 잘못된 데이터를 전달 받을 수 있다. 이를 방지하기 위해 패킷에 특정 규칙에 따라 고유 번호를 매겨 전송한다. 그러면 친구는 패킷들을 받아 나와 같은 규칙에 따라 데이터를 조합하는데, 이 규칙이 프로토콜이다.

<br/>
<br/>

## 🌏 TCP/IP 5계층

<br/>

### 💪 L1: 물리 계층(Physical layer)
---

물리 계층은 말 그대로 기기들이 연결되기 위한 물리적인 사항 (전선, 전압 등)을 정한다. 구리선, 광 케이블, 무선 전파 채널 등 물리적인 통신 채널을 통해 bit 신호를 주고 받는 역할을 한다.

<br/>

### ⛓ L2: 데이터 링크 계층(Data link layer)
---

통신 방법을 정하였다면, 이제 네트워크에 접속하는 하는 단계다. 네트워크에 연결된 컴퓨터들 간 충돌 없이 데이터를 주고 받기 위한 방법을 데이터 링크 계층에서 정의한다. 네트워크 내에서 컴퓨터를 구분하기 위해 각 컴퓨터는 주소 값을 할당 받는데, 이 주소를 MAC 주소라고 한다. MAC 주소는 랜카드가 만들어질 때부터 물리적으로 정해진다.

터미널에서 `arp -a` 로 자신의 MAC 주소를 확인할 수 있다.

<br/>

### 🌍 L3: 네트워크 계층(Network layer)
---

현재까지 물리적 통신 방법을 정하고, 네트워크에서 접속 하였다. 이제 인터넷에 연결되기 위해 다른 네트워크와 연결하는 작업을 해야 한다. 인터넷에서는 전세계의 모든 컴퓨터들이 연결되어 있는데, 이렇게 연결된 컴퓨터들을 구분하기 위한 또 다른 방법이 필요하다. 이를 네트워크 계층에서 기술한다.

각 네트워크는 라우터라는 장치를 통해 연결된다. 라우터를 통해 MAC 주소 체계가 서로 다른 네트워크라도 연결이 가능하다. 하지만 네트워크간 MAC 주소 체계가 달라, 다른 네트워크에 속하는 컴퓨터의 주소를 알 수 없다. 인터넷에 연결된 모든 컴퓨터를 구분하기 위한 주소가 바로 IP 주소다.

<br/>

### 📩 L4: 수송 계층(Transport layer)
---

이제 인터넷에 연결이 되었다! 이를 통해 IP 주소를 명시한 패킷을 보내면 해당 컴퓨터에 패킷이 도착한다. 패킷이 도착한 컴퓨터에는 많은 프로그램들이 실행 중인데, 이 패킷을 어떤 프로그램이 가져가는지 알려줄 필요가 있을 것이다. 이를 포트(Port) 번호라고 한다. 포트 번호를 관리하는 역할을 수송 계층의 프로토콜이 담당한다. 예를 들어서 웹 프로토콜인 HTTP는 80번 포트를 사용한다.

또한 오류와 신뢰성에 관한 역할을 하는데, 패킷이 누락되거나 중복되지는 않았는지 최종 확인하는 역할을 한다. 이와 관련된 프로토콜이 TCP(전송 제어 프로토콜)이다. TCP와는 다르게 오류를 처리하지 않고 패킷을 전달만 하는 UDP(사용자 데이터그램 프로토콜)도 있다. 반응 속도가 중요한 게임과 같은 프로그램이 이를 사용한다.

<br/>

### 🛼 L5: 응용 계층(Application layer)
---

L1 ~ L4 계층을 통해 통신 방법 정의, 네트워크 접속, 인터넷 연결 및 포트 번호 관리를 통해 컴퓨터 프로그램 간 완벽한 통신이 준비되었다. 이제 프로그램들 간 메시지를 전송하고 수신하는 대화가 가능하다. 이러한 대화에 관한 프로토콜이 응용 계층에서 정의된다. 웹 서비스를 제공하기 위한 HTTP, 메일을 전송하기 위한 SMTP, 파일 전송을 위한 FTP나 도메인 주소를 IP 주소로 변환시켜 주는 DNS 프로토콜 등이 이에 속한다.